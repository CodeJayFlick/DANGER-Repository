
This code is quite complex and hard to read. It's a good idea to refactor it into smaller methods or classes that are easier to understand.

Also, note that there are many repeated patterns in this code (e.g., `assertEquals("0", model.getComposite());`), which could be extracted into separate methods for better readability and maintainability.
